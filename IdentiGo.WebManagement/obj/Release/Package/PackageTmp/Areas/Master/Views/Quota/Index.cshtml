@model IEnumerable<IdentiGo.Domain.Entity.Master.Quota>

@{
    ViewBag.Title = "Cupos";
}

<div class="row">
    <div class="col-sm-12">
        <div class="btn-group pull-right m-t-15">
            <button type="button" class="btn btn-default dropdown-toggle waves-effect waves-light" data-toggle="dropdown" aria-expanded="false">Ajustes <span class="m-l-5"><i class="fa fa-cog"></i></span></button>
            <ul class="dropdown-menu drop-menu-right" role="menu">
                <li><a href="@Url.Action("Create")">Crear</a></li>
            </ul>
        </div>

        <h4 class="page-title">Cupos</h4>
        <ol class="breadcrumb"></ol>
    </div>
</div>
<div class="row">
    <div class="col-sm-12">
        <div class="card-box table-responsive">
            <h4 class="m-t-0 header-title"><b>Registros</b></h4>

            @*<table id="datatable-quota" class="table table-striped table-bordered">*@
            <table id="datatable" class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th>
                                @Html.DisplayNameFor(model => model.Name)
                            </th>

                            <th>
                                @Html.DisplayNameFor(model => model.Amount)
                            </th>

                            <th width="120">
                                Acciones
                            </th>
                        </tr>
                    </thead>

                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td>
                                    @Html.DisplayFor(modelItem => item.Name)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.Amount)
                                </td>

                                <td class="actions">
                                    <a href="@Url.Action("Edit", new { id = item.Id })" class="on-default edit-row"><i class="fa fa-pencil"></i></a>
                                    <a href="@Url.Action("Delete", new { id = item.Id })" class="on-default" style="color:red"><i class="fa fa-trash-o"></i></a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        var table = $('#datatable-quota').DataTable({
            'columnDefs': [
                {
                    'visible': false,
                    'targets': 0
                }
            ],
            'order': [[0, 'asc']],
            'displayLength': 25,
            'drawCallback': function (settings) {
                var api = this.api();
                var rows = api.rows({ page: 'current' }).nodes();
                var last = null;

                api.column(0, { page: 'current' }).data().each(function (group, i) {
                    if (last !== group) {
                        $(rows).eq(i).before(
                            '<tr class="group"><td colspan="2">'+group+'</td></tr>'        
                        );

                        last = group;
                    }
                });
            }
        });

        $('#datatable-quota tbody').on('click', 'tr.group', function () {
            var currentOrder = table.order()[0];

            if (currentOrder[0] === 0 && currentOrder[1] === 'asc') {
                table.order([0, 'desc']).draw();
            }
            else
            {
                table.order([0, 'asc']).draw();
            }
        });
    });
</script>